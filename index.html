<script>
  // === Sattvaa Water Website Script ===

  // 1️⃣ Enquiry form → Google Sheet
  const ENQUIRY_SCRIPT_URL = "https://script.google.com/macros/s/AKfycby2gH6ZoOaB9p0M0BjiriuMlRXzT_WLNQ3p3qjw-463VyuOHwmzpLwLNB1N__cgf8ff/exec";

  // 2️⃣ Image upload → Google Drive
  const IMAGE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwP_57ZCN_N7dzkYuZCdo2rAxyXpOdXZCSlBYhp0cJ5YV0Wrw_5IRGKHI5_PeJrUuwz/exec";

  // === Enquiry Form Handler ===
  async function handleSubmit(event) {
    event.preventDefault();
    const name = document.getElementById("name").value.trim();
    const phone = document.getElementById("phone").value.trim();
    const message = document.getElementById("message").value.trim();

    const data = { name, phone, message };

    try {
      const res = await fetch(ENQUIRY_SCRIPT_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data),
      });
      const result = await res.json();

      if (result.status === "success") {
        alert("✅ Thank you! Your enquiry has been sent successfully.");
        document.querySelector("form").reset();
      } else {
        alert("⚠️ Something went wrong: " + result.message);
      }
    } catch (err) {
      alert("⚠️ Error submitting form: " + err.message);
    }
  }

  // === Admin Image Upload Panel ===
  async function uploadImage(event, type) {
    event.preventDefault();
    const fileInput = document.getElementById(`${type}-file`);
    const file = fileInput.files[0];
    if (!file) return alert("⚠️ Please select an image first!");

    const formData = new FormData();
    formData.append("file", file);
    formData.append("type", type);

    try {
      const res = await fetch(IMAGE_SCRIPT_URL, { method: "POST", body: formData });
      const result = await res.json();

      if (result.status === "success") {
        alert(`✅ ${type.toUpperCase()} image uploaded successfully!`);
        loadImages(); // refresh images after upload
      } else {
        alert("⚠️ Upload failed: " + result.message);
      }
    } catch (err) {
      alert("⚠️ Upload error: " + err.message);
    }
  }

  // === Load Current Images from Drive ===
  async function loadImages() {
    try {
      const res = await fetch(IMAGE_SCRIPT_URL);
      const result = await res.json();
      if (result.status === "success" && result.images) {
        result.images.forEach(img => {
          if (img.type === "logo") document.getElementById("logo-preview").src = img.url;
          if (img.type === "banner") document.getElementById("banner-preview").src = img.url;
          if (img.type === "product") document.getElementById("product-preview").src = img.url;
        });
      }
    } catch (err) {
      console.error("Error loading images:", err);
    }
  }

  // === Show Admin Panel ===
  function checkAdmin() {
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get("admin") === "true") {
      document.getElementById("admin-panel").style.display = "block";
    }
  }

  // Initialize page
  window.onload = function() {
    checkAdmin();
    loadImages();
  };
</script>
